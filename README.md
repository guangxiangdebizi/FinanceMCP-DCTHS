# FinanceMCP-DCTHS

[![npm version](https://img.shields.io/npm/v/financemcp-dcths.svg)](https://www.npmjs.com/package/financemcp-dcths)
[![License](https://img.shields.io/npm/l/financemcp-dcths.svg)](https://github.com/guangxiangdebizi/FinanceMCP-DCTHS/blob/main/LICENSE)
[![Downloads](https://img.shields.io/npm/dm/financemcp-dcths.svg)](https://www.npmjs.com/package/financemcp-dcths)

> åŸºäº MCP åè®®çš„é‡‘èæ•°æ®æœåŠ¡å™¨ï¼Œé›†æˆ Tushare APIï¼Œæ”¯æŒä¸œè´¢å’ŒåŒèŠ±é¡ºæ•°æ®æº

## ğŸ“‹ åŠŸèƒ½ç‰¹æ€§

### ğŸ¯ å…­å¤§æ¿å—åˆ†æå·¥å…·

#### åŒèŠ±é¡ºï¼ˆTHSï¼‰æ•°æ®æº

1. **åŒèŠ±é¡ºæ¿å—æŒ‡æ•°åˆ—è¡¨** (`get_ths_index`)
   - è·å–åŒèŠ±é¡ºæ¦‚å¿µå’Œè¡Œä¸šæŒ‡æ•°åˆ—è¡¨
   - æ”¯æŒæŒ‰æŒ‡æ•°ä»£ç ã€å¸‚åœºç±»å‹ã€æŒ‡æ•°ç±»å‹æŸ¥è¯¢

2. **åŒèŠ±é¡ºæ¿å—è¡Œæƒ…** (`get_ths_daily`)
   - è·å–åŒèŠ±é¡ºæ¿å—æŒ‡æ•°è¡Œæƒ…æ•°æ®
   - åŒ…å«å¼€ç›˜ä»·ã€æ”¶ç›˜ä»·ã€æ¶¨è·Œå¹…ã€æˆäº¤é‡ç­‰

3. **åŒèŠ±é¡ºæ¿å—æˆåˆ†** (`get_ths_member`)
   - è·å–åŒèŠ±é¡ºæ¦‚å¿µæ¿å—æˆåˆ†è‚¡
   - å¯æŸ¥è¯¢æ¿å—åŒ…å«çš„è‚¡ç¥¨æˆ–è‚¡ç¥¨æ‰€å±æ¿å—

#### ä¸œæ–¹è´¢å¯Œï¼ˆDCï¼‰æ•°æ®æº

4. **ä¸œè´¢æ¿å—ä¿¡æ¯** (`get_dc_index`)
   - è·å–ä¸œè´¢æ¦‚å¿µæ¿å—æ¯æ—¥æ•°æ®
   - åŒ…å«é¢†æ¶¨è‚¡ã€æ€»å¸‚å€¼ã€æ¶¨è·Œå¹…ç­‰ä¿¡æ¯

5. **ä¸œè´¢æ¿å—æˆåˆ†** (`get_dc_member`)
   - è·å–ä¸œè´¢æ¿å—æˆåˆ†è‚¡æ•°æ®
   - æ”¯æŒå†å²æˆåˆ†æŸ¥è¯¢

6. **ä¸œè´¢æ¿å—è¡Œæƒ…** (`get_dc_daily`)
   - è·å–ä¸œè´¢æ¿å—è¡Œæƒ…æ•°æ®
   - æ”¯æŒæ¦‚å¿µæ¿å—ã€è¡Œä¸šæ¿å—ã€åœ°åŸŸæ¿å—

### ğŸ”§ ä¸¤ç§éƒ¨ç½²æ¨¡å¼

| ç‰¹æ€§ | stdio æ¨¡å¼ | HTTP æ¨¡å¼ |
|------|-----------|-----------|
| **é€‚ç”¨åœºæ™¯** | æœ¬åœ°ä½¿ç”¨ | æœåŠ¡å™¨éƒ¨ç½² |
| **å¯åŠ¨æ–¹å¼** | `npx -y financemcp-dcths` | `node build/httpServer.js` |
| **Token é…ç½®** | ç¯å¢ƒå˜é‡ | ç¯å¢ƒå˜é‡ + HTTP Header |
| **æ¨èç”¨é€”** | ä¸ªäººä½¿ç”¨ã€å¿«é€Ÿæµ‹è¯• | ç”Ÿäº§éƒ¨ç½²ã€å¤šç”¨æˆ· |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šç›´æ¥ä½¿ç”¨ï¼ˆæ¨èï¼‰â­

æ— éœ€å®‰è£…ï¼Œç›´æ¥ä½¿ç”¨ npxï¼š

```bash
npx -y financemcp-dcths
```

### æ–¹å¼äºŒï¼šä»æºç æ„å»º

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/guangxiangdebizi/FinanceMCP-DCTHS.git
cd FinanceMCP-DCTHS

# å®‰è£…ä¾èµ–
npm install
```

### ğŸ”‘ é…ç½® Tushare Token

1. å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿ï¼š
```bash
cp .env.example .env
```

2. ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„ Tushare Tokenï¼š
```env
TUSHARE_TOKEN=ä½ çš„tushare_token
```

> **è·å– Token**ï¼šè®¿é—® [Tushare å®˜ç½‘](https://tushare.pro/) æ³¨å†Œå¹¶è·å–å…è´¹ Token

### ğŸ”¨ æ„å»ºé¡¹ç›®

```bash
npm run build
```

### â–¶ï¸ è¿è¡ŒæœåŠ¡å™¨

#### stdio æ¨¡å¼ï¼ˆæ¨èæœ¬åœ°ä½¿ç”¨ï¼‰â­

```bash
npm run start:stdio
```

æˆ–é€šè¿‡ npx ç›´æ¥è¿è¡Œï¼š
```bash
npx -y financemcp-dcths
```

#### HTTP æ¨¡å¼ï¼ˆæœåŠ¡å™¨éƒ¨ç½²ï¼‰

```bash
npm run start:http
```

æœåŠ¡å™¨å°†åœ¨ `http://localhost:3000` å¯åŠ¨

## ğŸ“± å®¢æˆ·ç«¯é…ç½®

### â­ stdio æ¨¡å¼é…ç½®ï¼ˆæ¨èï¼‰

åœ¨ Claude Desktop é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š

**ä½ç½®**ï¼š
- macOS: `~/Library/Application Support/Claude/claude_desktop_config.json`
- Windows: `%APPDATA%\Claude\claude_desktop_config.json`

**é…ç½®å†…å®¹**ï¼š
```json
{
  "mcpServers": {
    "financemcp-dcths": {
      "command": "npx",
      "args": ["-y", "financemcp-dcths"],
      "env": {
        "TUSHARE_TOKEN": "ä½ çš„tushare_token"
      }
    }
  }
}
```

### ğŸŒ HTTP æ¨¡å¼é…ç½®

```json
{
  "mcpServers": {
    "financemcp-dcths": {
      "type": "streamableHttp",
      "url": "http://localhost:3000/mcp",
      "timeout": 600,
      "headers": {
        "X-Tushare-Token": "ä½ çš„tushare_token"
      }
    }
  }
}
```

**HTTP æ¨¡å¼æ”¯æŒä¸‰ç§ Token ä¼ é€’æ–¹å¼ï¼š**

1. âœ… `X-Tushare-Token` è¯·æ±‚å¤´ï¼ˆæ¨èï¼‰
2. âœ… `X-Api-Key` è¯·æ±‚å¤´
3. âœ… `Authorization: Bearer <token>` è¯·æ±‚å¤´

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šæŸ¥è¯¢åŒèŠ±é¡ºæ¦‚å¿µæ¿å—åˆ—è¡¨

åœ¨ Claude ä¸­è¾“å…¥ï¼š
```
æŸ¥è¯¢æ‰€æœ‰åŒèŠ±é¡ºæ¦‚å¿µæŒ‡æ•°
```

å¯¹åº”çš„ MCP è°ƒç”¨ï¼š
```json
{
  "name": "get_ths_index",
  "arguments": {
    "type": "N"
  }
}
```

### ç¤ºä¾‹ 2ï¼šæŸ¥è¯¢ä¸œè´¢æ¿å—ä»Šæ—¥æ•°æ®

åœ¨ Claude ä¸­è¾“å…¥ï¼š
```
æŸ¥è¯¢ä¸œè´¢äººå½¢æœºå™¨äººæ¿å—ä»Šå¤©çš„æ•°æ®
```

å¯¹åº”çš„ MCP è°ƒç”¨ï¼š
```json
{
  "name": "get_dc_index",
  "arguments": {
    "name": "äººå½¢æœºå™¨äºº",
    "trade_date": "20231201"
  }
}
```

### ç¤ºä¾‹ 3ï¼šæŸ¥è¯¢åŒèŠ±é¡ºæ¿å—è¡Œæƒ…

åœ¨ Claude ä¸­è¾“å…¥ï¼š
```
æŸ¥è¯¢åŒèŠ±é¡ºäººå·¥æ™ºèƒ½æ¿å—æœ€è¿‘ä¸€å‘¨çš„è¡Œæƒ…
```

å¯¹åº”çš„ MCP è°ƒç”¨ï¼š
```json
{
  "name": "get_ths_daily",
  "arguments": {
    "ts_code": "885823.TI",
    "start_date": "20231201",
    "end_date": "20231207"
  }
}
```

### ç¤ºä¾‹ 4ï¼šæŸ¥è¯¢æ¿å—æˆåˆ†è‚¡

åœ¨ Claude ä¸­è¾“å…¥ï¼š
```
æŸ¥è¯¢ä¸œè´¢æ–°èƒ½æºæ±½è½¦æ¿å—åŒ…å«å“ªäº›è‚¡ç¥¨
```

å¯¹åº”çš„ MCP è°ƒç”¨ï¼š
```json
{
  "name": "get_dc_member",
  "arguments": {
    "ts_code": "BK0001.DC",
    "trade_date": "20231201"
  }
}
```

## ğŸ“š API å‚æ•°è¯´æ˜

### ğŸ”µ åŒèŠ±é¡ºå·¥å…·å‚æ•°

#### get_ths_index - æ¿å—æŒ‡æ•°åˆ—è¡¨

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `ts_code` | string | âŒ | æŒ‡æ•°ä»£ç ï¼ˆå¦‚ 885823.TIï¼‰ |
| `exchange` | string | âŒ | å¸‚åœºç±»å‹ï¼šA-Aè‚¡ HK-æ¸¯è‚¡ US-ç¾è‚¡ |
| `type` | string | âŒ | æŒ‡æ•°ç±»å‹ï¼šN-æ¦‚å¿µæŒ‡æ•° I-è¡Œä¸šæŒ‡æ•° R-åœ°åŸŸæŒ‡æ•° ç­‰ |

#### get_ths_daily - æ¿å—è¡Œæƒ…

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `ts_code` | string | âŒ | æŒ‡æ•°ä»£ç ï¼ˆå¦‚ 885823.TIï¼‰ |
| `trade_date` | string | âŒ | äº¤æ˜“æ—¥æœŸï¼ˆYYYYMMDDï¼‰ |
| `start_date` | string | âŒ | å¼€å§‹æ—¥æœŸ |
| `end_date` | string | âŒ | ç»“æŸæ—¥æœŸ |

#### get_ths_member - æ¿å—æˆåˆ†

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `ts_code` | string | âŒ | æ¿å—æŒ‡æ•°ä»£ç ï¼ˆæŸ¥è¯¢è¯¥æ¿å—çš„æˆåˆ†è‚¡ï¼‰ |
| `con_code` | string | âŒ | è‚¡ç¥¨ä»£ç ï¼ˆæŸ¥è¯¢è¯¥è‚¡ç¥¨æ‰€å±æ¿å—ï¼‰ |

### ğŸŸ¢ ä¸œæ–¹è´¢å¯Œå·¥å…·å‚æ•°

#### get_dc_index - æ¿å—ä¿¡æ¯

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `ts_code` | string | âŒ | æŒ‡æ•°ä»£ç ï¼ˆæ”¯æŒå¤šä¸ªï¼Œé€—å·åˆ†éš”ï¼‰ |
| `name` | string | âŒ | æ¿å—åç§°ï¼ˆå¦‚ï¼šäººå½¢æœºå™¨äººï¼‰ |
| `trade_date` | string | âŒ | äº¤æ˜“æ—¥æœŸï¼ˆYYYYMMDDï¼‰ |
| `start_date` | string | âŒ | å¼€å§‹æ—¥æœŸ |
| `end_date` | string | âŒ | ç»“æŸæ—¥æœŸ |

#### get_dc_member - æ¿å—æˆåˆ†

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `ts_code` | string | âŒ | æ¿å—æŒ‡æ•°ä»£ç  |
| `con_code` | string | âŒ | æˆåˆ†è‚¡ç¥¨ä»£ç  |
| `trade_date` | string | âŒ | äº¤æ˜“æ—¥æœŸï¼ˆæ”¯æŒå†å²æŸ¥è¯¢ï¼‰ |

#### get_dc_daily - æ¿å—è¡Œæƒ…

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `ts_code` | string | âŒ | æ¿å—ä»£ç ï¼ˆæ ¼å¼ï¼šxxxxx.DCï¼‰ |
| `trade_date` | string | âŒ | äº¤æ˜“æ—¥æœŸï¼ˆYYYYMMDDï¼‰ |
| `start_date` | string | âŒ | å¼€å§‹æ—¥æœŸ |
| `end_date` | string | âŒ | ç»“æŸæ—¥æœŸ |
| `idx_type` | string | âŒ | æ¿å—ç±»å‹ï¼šæ¦‚å¿µæ¿å—ã€è¡Œä¸šæ¿å—ã€åœ°åŸŸæ¿å— |

## ğŸ” Token å®‰å…¨å»ºè®®

- âœ… **æœ¬åœ°å¼€å‘**ï¼šä½¿ç”¨ `.env` æ–‡ä»¶å­˜å‚¨ Tokenï¼ˆå·²åœ¨ `.gitignore` ä¸­æ’é™¤ï¼‰
- âœ… **ç”Ÿäº§éƒ¨ç½²**ï¼šä½¿ç”¨ç³»ç»Ÿç¯å¢ƒå˜é‡æˆ– Docker secrets
- âœ… **å®¢æˆ·ç«¯é…ç½®**ï¼šåœ¨å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶ä¸­ä¼ é€’ Token
- âŒ **é¿å…**ï¼šä¸è¦å°† Token ç¡¬ç¼–ç åœ¨ä»£ç ä¸­æˆ–æäº¤åˆ° Git

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ index.ts              # stdio æ¨¡å¼å…¥å£
â”œâ”€â”€ httpServer.ts         # HTTP æ¨¡å¼å…¥å£
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ tushareClient.ts  # Tushare API å®¢æˆ·ç«¯
â””â”€â”€ tools/
    â”œâ”€â”€ thsIndex.ts       # åŒèŠ±é¡ºæ¿å—æŒ‡æ•°åˆ—è¡¨
    â”œâ”€â”€ thsDaily.ts       # åŒèŠ±é¡ºæ¿å—è¡Œæƒ…
    â”œâ”€â”€ thsMember.ts      # åŒèŠ±é¡ºæ¿å—æˆåˆ†
    â”œâ”€â”€ dcIndex.ts        # ä¸œè´¢æ¿å—ä¿¡æ¯
    â”œâ”€â”€ dcMember.ts       # ä¸œè´¢æ¿å—æˆåˆ†
    â””â”€â”€ dcDaily.ts        # ä¸œè´¢æ¿å—è¡Œæƒ…
```

### å¼€å‘æ¨¡å¼

```bash
# ç›‘å¬æ–‡ä»¶å˜åŒ–ï¼Œè‡ªåŠ¨ç¼–è¯‘
npm run watch

# å¦å¼€ç»ˆç«¯è¿è¡ŒæœåŠ¡å™¨
npm run dev
```

### æ·»åŠ æ–°å·¥å…·

1. åœ¨ `src/tools/` ç›®å½•ä¸‹åˆ›å»ºæ–°å·¥å…·æ–‡ä»¶
2. å®ç°å·¥å…·æ¥å£ï¼ˆname, description, parameters, runï¼‰
3. åœ¨ `src/index.ts` å’Œ `src/httpServer.ts` ä¸­å¯¼å…¥å¹¶æ³¨å†Œå·¥å…·

### å·¥å…·æƒé™è¦æ±‚

æ‰€æœ‰å·¥å…·å‡éœ€è¦ **5000-6000 ç§¯åˆ†**çš„ Tushare è´¦å·æƒé™ã€‚å…·ä½“æƒé™è¦æ±‚ï¼š
- `get_ths_index`: éœ€è¦ 6000 ç§¯åˆ†
- `get_ths_daily`: éœ€è¦ 6000 ç§¯åˆ†
- `get_ths_member`: éœ€è¦ 5000 ç§¯åˆ†
- `get_dc_index`: éœ€è¦ 6000 ç§¯åˆ†
- `get_dc_member`: éœ€è¦ 6000 ç§¯åˆ†
- `get_dc_daily`: éœ€è¦ 6000 ç§¯åˆ†

## ğŸ› å¸¸è§é—®é¢˜

### Q: æç¤º "Tushare token is required"

**A**: æ£€æŸ¥ Token é…ç½®ï¼š
1. stdio æ¨¡å¼ï¼šæ£€æŸ¥ç¯å¢ƒå˜é‡æˆ–å®¢æˆ·ç«¯é…ç½®çš„ `env.TUSHARE_TOKEN`
2. HTTP æ¨¡å¼ï¼šæ£€æŸ¥è¯·æ±‚å¤´ `X-Tushare-Token` æˆ–ç¯å¢ƒå˜é‡

### Q: æç¤º "Tushare API Error: æƒé™é”™è¯¯"

**A**: æŸäº›æ¥å£éœ€è¦ Tushare ä¼šå‘˜æƒé™ï¼Œè¯·ï¼š
1. è®¿é—® [Tushare ç§¯åˆ†å•†åŸ](https://tushare.pro/document/1?doc_id=13)
2. æŸ¥çœ‹æ¥å£æ‰€éœ€ç§¯åˆ†ç­‰çº§
3. å‡çº§è´¦æˆ·æƒé™

### Q: è¿”å›æ•°æ®ä¸ºç©º

**A**: å¯èƒ½åŸå› ï¼š
1. æ—¥æœŸå‚æ•°é”™è¯¯ï¼ˆéäº¤æ˜“æ—¥ï¼‰
2. è‚¡ç¥¨ä»£ç æˆ–æ¿å—ä»£ç é”™è¯¯
3. è¯¥æ—¥æœŸæ²¡æœ‰æ•°æ®

## ğŸ“„ å¼€æºåè®®

Apache-2.0 License - è¯¦è§ [LICENSE](./LICENSE) æ–‡ä»¶

## ğŸ‘¤ ä½œè€…

**é™ˆæ˜Ÿå®‡ (Xingyu Chen)**

- **LinkedIn**: [Xingyu Chen](https://www.linkedin.com/in/xingyu-chen-b5b3b0313/)
- **Email**: guangxiangdebizi@gmail.com
- **GitHub**: [@guangxiangdebizi](https://github.com/guangxiangdebizi/)
- **NPM**: [@xingyuchen](https://www.npmjs.com/~xingyuchen)
- **NPM åŒ…**: [financemcp-dcths](https://www.npmjs.com/package/financemcp-dcths)

## ğŸ™ è‡´è°¢

- [Model Context Protocol](https://modelcontextprotocol.io/) - MCP SDK
- [Tushare Pro](https://tushare.pro/) - é‡‘èæ•°æ® API
- [ä¸œæ–¹è´¢å¯Œ](https://www.eastmoney.com/) - æ•°æ®æ¥æºï¼ˆæ¦‚å¿µæ¿å—ã€è¡Œä¸šæ¿å—æ•°æ®ï¼‰
- [åŒèŠ±é¡º](https://www.10jqka.com.cn/) - æ•°æ®æ¥æºï¼ˆæ¦‚å¿µæŒ‡æ•°ã€æ¿å—è¡Œæƒ…æ•°æ®ï¼‰

## âš ï¸ æ•°æ®ç‰ˆæƒå£°æ˜

æœ¬é¡¹ç›®ä½¿ç”¨çš„æ¿å—æ•°æ®æ¥æºäºï¼š
- **åŒèŠ±é¡ºï¼ˆTHSï¼‰æ•°æ®**ï¼šæ•°æ®ç‰ˆæƒå½’å±åŒèŠ±é¡ºã€‚å¦‚éœ€å•†ä¸šç”¨é€”ï¼Œè¯·è”ç³»åŒèŠ±é¡ºè·å–æˆæƒã€‚
- **ä¸œæ–¹è´¢å¯Œï¼ˆDCï¼‰æ•°æ®**ï¼šæ•°æ®ç‰ˆæƒå½’å±ä¸œæ–¹è´¢å¯Œã€‚å¦‚éœ€å•†ä¸šç”¨é€”ï¼Œè¯·è”ç³»ä¸œæ–¹è´¢å¯Œè·å–æˆæƒã€‚

æœ¬å·¥å…·ä»…ä¾›ä¸ªäººå­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ã€‚

## ğŸ“® åé¦ˆä¸è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

- ğŸ› æŠ¥å‘Š Bug
- ğŸ’¡ æå‡ºæ–°åŠŸèƒ½å»ºè®®
- ğŸ“– æ”¹è¿›æ–‡æ¡£
- ğŸ”§ æäº¤ä»£ç 

---

**âš ï¸ å…è´£å£°æ˜**ï¼š

æœ¬å·¥å…·ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œæ•°æ®æ¥æºäº Tushare APIã€‚ä½¿ç”¨æœ¬å·¥å…·éœ€è¦éµå®ˆ Tushare çš„ä½¿ç”¨æ¡æ¬¾ã€‚ä»»ä½•æŠ•èµ„å†³ç­–è¯·è°¨æ…ï¼Œæœ¬å·¥å…·ä½œè€…ä¸æ‰¿æ‹…ä»»ä½•æŠ•èµ„é£é™©å’ŒæŸå¤±ã€‚

